-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                               ๐ Bronze Table Data Load ๐                                โ
-- โ   Insert data from staged CSV files into bronze tables, casting columns to correct types   โ
-- โ   and skipping header rows. Each statement loads a specific entity from the volume.        โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.crm_prd_info ๐งน                        โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_prd_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of crm_prd_info Table at ', CAST(ts_truncate_start_prd_info AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.crm_prd_info;

DECLARE ts_truncate_end_prd_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of crm_prd_info Table at ', CAST(ts_truncate_end_prd_info AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_prd_info) - UNIX_TIMESTAMP(ts_truncate_start_prd_info), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.crm_cust_info ๐งน                       โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_cust_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of crm_cust_info Table at ', CAST(ts_truncate_start_cust_info AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.crm_cust_info;

DECLARE ts_truncate_end_cust_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of crm_cust_info Table at ', CAST(ts_truncate_end_cust_info AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_cust_info) - UNIX_TIMESTAMP(ts_truncate_start_cust_info), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.crm_sales_details ๐งน                   โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_sales_details TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of crm_sales_details Table at ', CAST(ts_truncate_start_sales_details AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.crm_sales_details;

DECLARE ts_truncate_end_sales_details TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of crm_sales_details Table at ', CAST(ts_truncate_end_sales_details AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_sales_details) - UNIX_TIMESTAMP(ts_truncate_start_sales_details), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.erp_cust_az12 ๐งน                       โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_erp_cust_az12 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of erp_cust_az12 Table at ', CAST(ts_truncate_start_erp_cust_az12 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.erp_cust_az12;

DECLARE ts_truncate_end_erp_cust_az12 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of erp_cust_az12 Table at ', CAST(ts_truncate_end_erp_cust_az12 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_erp_cust_az12) - UNIX_TIMESTAMP(ts_truncate_start_erp_cust_az12), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.erp_loc_a101 ๐งน                        โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_erp_loc_a101 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of erp_loc_a101 Table at ', CAST(ts_truncate_start_erp_loc_a101 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.erp_loc_a101;

DECLARE ts_truncate_end_erp_loc_a101 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of erp_loc_a101 Table at ', CAST(ts_truncate_end_erp_loc_a101 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_erp_loc_a101) - UNIX_TIMESTAMP(ts_truncate_start_erp_loc_a101), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐งน TRUNCATE: datawarehouse.bronze.erp_px_cat_g1v2 ๐งน                     โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_truncate_start_erp_px_cat_g1v2 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Truncate of erp_px_cat_g1v2 Table at ', CAST(ts_truncate_start_erp_px_cat_g1v2 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

TRUNCATE TABLE datawarehouse.bronze.erp_px_cat_g1v2;

DECLARE ts_truncate_end_erp_px_cat_g1v2 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Truncate of erp_px_cat_g1v2 Table at ', CAST(ts_truncate_end_erp_px_cat_g1v2 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for truncate: ', CAST(ROUND(UNIX_TIMESTAMP(ts_truncate_end_erp_px_cat_g1v2) - UNIX_TIMESTAMP(ts_truncate_start_erp_px_cat_g1v2), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

---------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.crm_prd_info ๐ฅ                          โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_prd_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into crm_prd_info Table at ', CAST(ts_insert_start_prd_info AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.crm_prd_info
SELECT 
  CAST(_c0 AS INT) AS prd_id,
  _c1 AS prd_key,
  _c2 AS prd_nm,
  CAST(_c3 AS DECIMAL(18,2)) AS prd_cost,
  _c4 AS prd_line,
  CAST(_c5 AS DATE) AS prd_start_dt,
  CAST(_c6 AS DATE) AS prd_end_dt
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/prd_info.csv`
WHERE _c0 != 'prd_id';

DECLARE ts_insert_end_prd_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into crm_prd_info Table at ', CAST(ts_insert_end_prd_info AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_prd_info) - UNIX_TIMESTAMP(ts_insert_start_prd_info), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.crm_cust_info ๐ฅ                         โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_cust_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into crm_cust_info Table at ', CAST(ts_insert_start_cust_info AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.crm_cust_info
SELECT 
  CAST(_c0 AS INT) AS cst_id,
  _c1 AS cst_key,
  _c2 AS cst_firstname,
  _c3 AS cst_lastname,
  _c4 AS cst_marital_status,
  _c5 AS cst_gndr,
  CAST(_c6 AS DATE) AS cst_create_date
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/cust_info.csv`
WHERE _c1 != 'cst_key';

DECLARE ts_insert_end_cust_info TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into crm_cust_info Table at ', CAST(ts_insert_end_cust_info AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_cust_info) - UNIX_TIMESTAMP(ts_insert_start_cust_info), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.crm_sales_details ๐ฅ                     โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_sales_details TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into crm_sales_details Table at ', CAST(ts_insert_start_sales_details AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.crm_sales_details
SELECT 
  _c0 AS sls_ord_num,
  _c1 AS sls_prd_key,
  CAST(_c2 AS INT) AS sls_cust_id,
  CAST(_c3 AS INT) AS sls_order_dt,
  CAST(_c4 AS INT) AS sls_ship_dt,
  CAST(_c5 AS INT) AS sls_due_dt,
  CAST(_c6 AS INT) AS sls_sales,
  CAST(_c7 AS INT) AS sls_quantity,
  CAST(_c8 AS INT) AS sls_price
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/sales_details.csv`
WHERE _c0 != 'sls_ord_num';

DECLARE ts_insert_end_sales_details TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into crm_sales_details Table at ', CAST(ts_insert_end_sales_details AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_sales_details) - UNIX_TIMESTAMP(ts_insert_start_sales_details), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.erp_cust_az12 ๐ฅ                         โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_erp_cust_az12 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into erp_cust_az12 Table at ', CAST(ts_insert_start_erp_cust_az12 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.erp_cust_az12
SELECT 
  _c0 AS cid,
  CAST(_c1 AS DATE) as bdate,
  _c2 AS gen
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/CUST_AZ12.csv`
WHERE _c0 != 'CID';

DECLARE ts_insert_end_erp_cust_az12 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into erp_cust_az12 Table at ', CAST(ts_insert_end_erp_cust_az12 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_erp_cust_az12) - UNIX_TIMESTAMP(ts_insert_start_erp_cust_az12), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.erp_loc_a101 ๐ฅ                          โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_erp_loc_a101 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into erp_loc_a101 Table at ', CAST(ts_insert_start_erp_loc_a101 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.erp_loc_a101
SELECT 
  _c0 AS cid,
  _c1 AS cntry
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/LOC_A101.csv`
WHERE _c0 != 'CID';

DECLARE ts_insert_end_erp_loc_a101 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into erp_loc_a101 Table at ', CAST(ts_insert_end_erp_loc_a101 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_erp_loc_a101) - UNIX_TIMESTAMP(ts_insert_start_erp_loc_a101), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

------------------------------------------------------------------------------------------------------------------
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
-- โ                 ๐ฅ INSERT: datawarehouse.bronze.erp_px_cat_g1v2 ๐ฅ                       โ
-- โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
DECLARE ts_insert_start_erp_px_cat_g1v2 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ก [START] Insert into erp_px_cat_g1v2 Table at ', CAST(ts_insert_start_erp_px_cat_g1v2 AS STRING));
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

INSERT INTO datawarehouse.bronze.erp_px_cat_g1v2
SELECT 
  _c0 AS id,
  _c1 AS cat,
  _c2 AS subcat,
  _c3 AS maintenance
FROM csv.`/Volumes/datawarehouse/bronze/bronze_stage/PX_CAT_G1V2.csv`
WHERE _c0 != 'ID';

DECLARE ts_insert_end_erp_px_cat_g1v2 TIMESTAMP DEFAULT CURRENT_TIMESTAMP();

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT CONCAT('๐ข [END] Insert into erp_px_cat_g1v2 Table at ', CAST(ts_insert_end_erp_px_cat_g1v2 AS STRING));
SELECT CONCAT('โฑ๏ธ Time taken for insert: ', CAST(ROUND(UNIX_TIMESTAMP(ts_insert_end_erp_px_cat_g1v2) - UNIX_TIMESTAMP(ts_insert_start_erp_px_cat_g1v2), 2) AS STRING), ' seconds');
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';

SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
SELECT 'โ                  ๐ Bronze table data load complete! ๐                                 โ';
SELECT 'โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ';
------------------------------------------------------------------------------------------------------------------